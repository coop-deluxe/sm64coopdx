#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"
#include "game/level_update.h"
#include "levels/scripts.h"
#include "actors/common1.h"
#include "make_const_nonconst.h"

#include "areas/1/custom.model.inc.h"
#include "levels/bob/header.h"
extern u8 _bob_segment_ESegmentRomStart[]; 
extern u8 _bob_segment_ESegmentRomEnd[];
#include "levels/hmc/header.h"

const LevelScript level_bob_entry[] = {
    INIT_LEVEL(),
    LOAD_MIO0(0x07, _hmc_segment_7SegmentRomStart, _hmc_segment_7SegmentRomEnd),
    LOAD_MIO0_TEXTURE(/*seg*/ 0x09, _cave_mio0SegmentRomStart, _cave_mio0SegmentRomEnd),
    LOAD_RAW(0x1A, _hmcSegmentRomStart, _hmcSegmentRomEnd),
    LOAD_RAW(0x0E, _bob_segment_ESegmentRomStart, _bob_segment_ESegmentRomEnd),
    LOAD_MIO0(0xA,_water_skybox_mio0SegmentRomStart,_water_skybox_mio0SegmentRomEnd),
    LOAD_MIO0(8,_common0_mio0SegmentRomStart,_common0_mio0SegmentRomEnd),
    LOAD_RAW(15,_common0_geoSegmentRomStart,_common0_geoSegmentRomEnd),
    LOAD_MIO0(5,_group3_mio0SegmentRomStart,_group3_mio0SegmentRomEnd),
    LOAD_RAW(12,_group3_geoSegmentRomStart,_group3_geoSegmentRomEnd),
    LOAD_MIO0(6,_group14_mio0SegmentRomStart,_group14_mio0SegmentRomEnd),
    LOAD_RAW(13,_group14_geoSegmentRomStart,_group14_geoSegmentRomEnd),
    ALLOC_LEVEL_POOL(),
    MARIO(/*model*/ MODEL_MARIO, /*behParam*/ 0x00000001, /*beh*/ bhvMario),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_WOODEN_DOOR,          wooden_door_geo),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_DOOR,           metal_door_geo),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_HAZY_MAZE_DOOR,       hazy_maze_door_geo),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_PLATFORM,       hmc_geo_0005A0),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_ARROW_PLATFORM, hmc_geo_0005B8),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_ELEVATOR_PLATFORM,    hmc_geo_0005D0),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_ROLLING_ROCK,         hmc_geo_000548),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_ROCK_PIECE,           hmc_geo_000570),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_ROCK_SMALL_PIECE,     hmc_geo_000588),
    LOAD_MODEL_FROM_GEO(MODEL_HMC_RED_GRILLS,           hmc_geo_000530),
    LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_16, warp_pipe_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CASTLE_GROUNDS_BUBBLY_TREE, bubbly_tree_geo),
    LOAD_MODEL_FROM_GEO(MODEL_COURTYARD_SPIKY_TREE, spiky_tree_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CCM_SNOW_TREE, snow_tree_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CASTLE_DOOR_0_STARS, castle_door_0_star_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CASTLE_DOOR_1_STAR, castle_door_1_star_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CASTLE_DOOR_3_STARS, castle_door_3_star_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CASTLE_KEY_DOOR, key_door_geo),
    LOAD_MODEL_FROM_GEO(MODEL_CASTLE_CASTLE_DOOR, castle_door_geo),
    LOAD_MODEL_FROM_GEO(MODEL_BOB_BARS_GRILLS, palm_tree_geo), // Is it supposed to be MODEL_SSL_PALM_TREE..?
    // LOAD_MODEL_FROM_DL(132,0x08025f08,4),
    // LOAD_MODEL_FROM_DL(158,0x0302c8a0,4),
    // LOAD_MODEL_FROM_DL(159,0x0302bcd0,4),
    // LOAD_MODEL_FROM_DL(161,0x0301cb00,4),
    // LOAD_MODEL_FROM_DL(164,0x04032a18,4),
    // LOAD_MODEL_FROM_DL(201,0x080048e0,4),
    // LOAD_MODEL_FROM_DL(218,0x08024bb8,4),
    JUMP_LINK(script_func_global_1),
    JUMP_LINK(script_func_global_4),
    JUMP_LINK(script_func_global_15),
    JUMP_LINK(local_area_bob_1_),
    FREE_LEVEL_POOL(),
    MARIO_POS(1,0,-1644,-557,-3724),
    CALL(/*arg*/ 0, /*func*/ lvl_init_or_update),
    CALL_LOOP(/*arg*/ 1, /*func*/ lvl_init_or_update),
    CLEAR_LEVEL(),
    SLEEP_BEFORE_EXIT(/*frames*/ 1),
    EXIT(),
};

const LevelScript local_area_bob_1_[] = {
    AREA(1,Geo_bob_1_0x1661700),
    TERRAIN(col_bob_1_0xe037a40),
    SET_BACKGROUND_MUSIC(0,3),
    TERRAIN_TYPE(0),
    JUMP_LINK(local_objects_bob_1_),
    JUMP_LINK(local_warps_bob_1_),
    END_AREA(),
    RETURN()
};

const LevelScript local_objects_bob_1_[] = {
    OBJECT_WITH_ACTS(0,-1644,-557,-3724,0,0,0,0xa0000, bhvSpinAirborneWarp,63),
    OBJECT_WITH_ACTS(137,-3463,-519,2645,0,315,0,0x50000, bhvExclamationBox,63),
    OBJECT_WITH_ACTS(116,-2106,-1067,935,0,-153,0,0x0, bhvOneCoin,63),
    OBJECT_WITH_ACTS(116,-2380,-975,1267,0,107,0,0x0, bhvOneCoin,63),
    OBJECT_WITH_ACTS(195,-1767,-1808,-2593,0,180,0,0x9e0000, bhvBobombBuddy,62),
    OBJECT_WITH_ACTS(102,-5352,-2015,2524,0,180,0,0x0, bhvChainChomp,63),
    OBJECT_WITH_ACTS(86,4755,1625,3956,0,256,0,0x0, bhvKingBobomb,1),
    OBJECT_WITH_ACTS(122,-5230,-5791,-5245,0,0,0,0x4000000, bhvStar,63),
    OBJECT_WITH_ACTS(122,4404,46,-2819,0,83,0,0x1000000, bhvStar,127),
    OBJECT_WITH_ACTS(137,-5230,-1156,-5255,0,0,0,0x20000, bhvExclamationBox,63),
    OBJECT_WITH_ACTS(195,221,1213,600,0,0,0,0x0, bhvBobombBuddyOpensCannon,63),
    OBJECT_WITH_ACTS(23,355,307,1684,0,280,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(201,-467,-2015,-5118,0,0,0,0x0, bhvCannonClosed,63),
    OBJECT_WITH_ACTS(23,-794,-2014,-5604,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(137,-2877,-791,5528,0,0,0,0x20b0000, bhvExclamationBox,63),
    OBJECT_WITH_ACTS(0,-3718,619,4549,0,0,0,0x3000000, bhvHiddenRedCoinStar,63),
    OBJECT_WITH_ACTS(23,-3661,305,5029,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(215,4484,-1308,-7120,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(215,4384,-1390,-527,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(212,4355,-611,141,0,0,0,0x0, bhv1Up,63),
    OBJECT_WITH_ACTS(56,-5518,-2115,-2907,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(215,1934,406,2277,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(188,-5451,-2116,-4164,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(188,-4791,-2086,-2193,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(0,-5518,-2115,-2903,0,0,0,0x20000, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(128,-2808,305,3150,0,203,0,0x0, bhvWaterBombCannon,63),
    OBJECT_WITH_ACTS(188,-3054,306,3273,0,190,0,0x10000, bhvBobomb,63),
    OBJECT_WITH_ACTS(140,-353,-2013,4475,0,321,0,0x0, bhvBlueCoinSwitch,63),
    OBJECT_WITH_ACTS(0,-3289,-2016,-954,0,0,0,0x0, bhvWaterBombSpawner,63),
    OBJECT_WITH_ACTS(0,-5026,-2013,1288,0,0,0,0x0, bhvWaterBombSpawner,63),
    OBJECT_WITH_ACTS(23,-1403,-1583,318,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(118,-323,-1597,4500,0,0,0,0x0, bhvHiddenBlueCoin,63),
    OBJECT_WITH_ACTS(120,4619,1056,1980,0,0,0,0x0, bhvRecoveryHeart,63),
    OBJECT_WITH_ACTS(118,-731,-2009,4989,0,0,0,0x0, bhvHiddenBlueCoin,63),
    OBJECT_WITH_ACTS(118,-770,-1260,4993,0,0,0,0x0, bhvHiddenBlueCoin,63),
    OBJECT_WITH_ACTS(118,-1409,-1069,5508,0,0,0,0x0, bhvHiddenBlueCoin,63),
    OBJECT_WITH_ACTS(192,-544,-1586,-31,0,0,0,0x0, bhvGoomba,63),
    OBJECT_WITH_ACTS(23,-4689,-2014,273,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(0,82,307,2929,0,0,0,0x0, bhvGoombaTripletSpawner,63),
    OBJECT_WITH_ACTS(187,-590,516,3777,0,0,0,0x0, bhvButterfly,63),
    OBJECT_WITH_ACTS(215,6212,974,5021,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(187,-2969,-1917,374,0,0,0,0x0, bhvButterfly,63),
    OBJECT_WITH_ACTS(215,-5357,-1749,4097,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(188,901,-2147,4280,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(215,-888,-890,-2947,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(0,-891,-890,-2958,0,0,0,0x20000, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(195,-1767,-1808,-2593,0,180,0,0x10000, bhvBobombBuddy,1),
    OBJECT_WITH_ACTS(23,-1307,-1806,-2037,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(187,-2222,-1652,-3222,0,0,0,0x0, bhvButterfly,63),
    OBJECT_WITH_ACTS(215,1211,-2048,3246,0,0,0,0x0, bhvRedCoin,63),
    OBJECT_WITH_ACTS(215,-1082,1222,5062,0,0,0,0x0, bhvRedCoin,255),
    OBJECT_WITH_ACTS(192,-4197,-2017,198,0,0,0,0x0, bhvGoomba,63),
    OBJECT_WITH_ACTS(107,-6009,-2115,-3594,0,0,0,0x0, bhvWoodenPost,63),
    OBJECT_WITH_ACTS(107,-4967,-2115,-6189,0,0,0,0x0, bhvWoodenPost,63),
    OBJECT_WITH_ACTS(0,2605,-2741,-3788,0,0,0,0x0, bhvLargeFishGroup,63),
    OBJECT_WITH_ACTS(0,2317,-2701,1949,0,0,0,0x0, bhvLargeFishGroup,63),
    OBJECT_WITH_ACTS(0,4491,-3500,-5444,0,270,0,0x0, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(107,601,-2147,4625,0,0,0,0x0, bhvWoodenPost,63),
    OBJECT_WITH_ACTS(0,3993,-2691,-1560,0,0,0,0x0, bhvLargeFishGroup,63),
    OBJECT_WITH_ACTS(23,-541,307,4459,0,51,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(137,5706,1244,2540,0,326,0,0x60000, bhvExclamationBox,63),
    OBJECT_WITH_ACTS(23,3914,972,5302,0,58,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(0,5400,1877,2060,90,0,0,0x130000, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(0,-3184,-779,2309,0,0,0,0x0, bhvWaterBombSpawner,63),
    OBJECT_WITH_ACTS(129,-1144,-230,2409,0,46,0,0x10000, bhvBreakableBox,63),
    OBJECT_WITH_ACTS(192,4514,-1974,-5552,0,0,0,0x0, bhvGoomba,63),
    OBJECT_WITH_ACTS(116,2173,742,3889,0,0,0,0x0, bhvOneCoin,63),
    OBJECT_WITH_ACTS(116,775,307,3891,0,0,0,0x0, bhvOneCoin,63),
    OBJECT_WITH_ACTS(0,540,307,431,0,34,0,0x0, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(0,4382,-1447,-399,110,0,0,0x130000, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(0,4458,-2852,-3769,110,0,0,0x130000, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(0,-5334,-2013,485,0,133,0,0x0, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(116,-2664,-881,1608,0,0,0,0x0, bhvOneCoin,63),
    OBJECT_WITH_ACTS(187,-1437,-2014,-5525,0,0,0,0x0, bhvButterfly,63),
    OBJECT_WITH_ACTS(0,-2203,-2135,3239,0,87,0,0x0, bhvCoinFormation,63),
    OBJECT_WITH_ACTS(188,-506,304,1575,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(188,-1093,-2015,-5321,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(195,381,-2015,-1484,0,264,0,0x20000, bhvBobombBuddy,63),
    OBJECT_WITH_ACTS(124,-1939,304,4715,0,180,0,0x580000, bhvMessagePanel,95),
    OBJECT_WITH_ACTS(0,-1934,843,5208,0,0,0,0x70000, bhvExclamationBox,95),
    OBJECT_WITH_ACTS(60,-4781,-2004,2280,0,0,0,0x0, bhvSMSRBreakableRock,63),
    OBJECT_WITH_ACTS(60,-3666,-2004,1825,0,0,0,0x0, bhvSMSRBreakableRock,63),
    OBJECT_WITH_ACTS(60,-5901,-2004,2481,0,0,0,0x0, bhvSMSRBreakableRock,63),
    OBJECT_WITH_ACTS(60,-5647,-2004,3624,0,0,0,0x0, bhvSMSRBreakableRock,63),
    OBJECT_WITH_ACTS(60,-5509,-2004,942,0,0,0,0x0, bhvSMSRBreakableRock,63),
    OBJECT_WITH_ACTS(0,-4781,-2237,2280,0,237,0,0x0, bhvSMSRHiddenStarTrigger,63),
    OBJECT_WITH_ACTS(0,-3666,-2237,1825,0,0,0,0x0, bhvSMSRHiddenStarTrigger,63),
    OBJECT_WITH_ACTS(0,-5901,-2237,2481,0,0,0,0x0, bhvSMSRHiddenStarTrigger,63),
    OBJECT_WITH_ACTS(0,-5647,-2237,3624,0,0,0,0x0, bhvSMSRHiddenStarTrigger,63),
    OBJECT_WITH_ACTS(0,-5509,-2237,942,0,0,0,0x0, bhvSMSRHiddenStarTrigger,63),
    OBJECT_WITH_ACTS(0,-4694,-1182,262,0,236,0,0x5000000, bhvSMSRHiddenStar,63),
    OBJECT_WITH_ACTS(194,-5253,-2604,-5253,0,0,0,0x0, bhvHomingAmp,63),
    OBJECT_WITH_ACTS(194,-5253,-3802,-5253,0,0,0,0x0, bhvHomingAmp,63),
    OBJECT_WITH_ACTS(194,-5253,-5000,-5253,0,0,0,0x0, bhvHomingAmp,63),
    OBJECT_WITH_ACTS(56,-5886,-2116,-4463,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(188,-3013,304,4544,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(188,4064,971,2824,0,0,0,0x0, bhvBobomb,63),
    OBJECT_WITH_ACTS(58,1196,595,3189,0,0,0,0x0, bhvSMSRWoodenOctagonalPlatform,63),
    OBJECT_WITH_ACTS(58,2756,937,3529,0,0,0,0x0, bhvSMSRWoodenOctagonalPlatform,63),
    OBJECT_WITH_ACTS(58,4057,-1613,516,0,0,0,0x0, bhvSMSRWoodenOctagonalPlatform,63),
    OBJECT_WITH_ACTS(56,-4125,-2096,-5398,0,0,0,0x0, bhvTree,63),
    OBJECT_WITH_ACTS(188,5134,1623,4256,0,0,0,0x0, bhvBobomb,62),

    RETURN()
};

const LevelScript local_warps_bob_1_[] = {
    WARP_NODE(10,9,1,10,0),
    WARP_NODE(11,9,1,12,0),
    WARP_NODE(12,9,1,11,0),
    WARP_NODE(13,9,1,14,0),
    WARP_NODE(14,9,1,13,0),
    WARP_NODE(240,16,1,21,0),
    WARP_NODE(241,16,1,22,0),
    WARP_NODE(0,9,1,10,0),
    WARP_NODE(1,9,1,10,0),
    WARP_NODE(2,9,1,10,0),
    WARP_NODE(3,9,1,10,0),
    WARP_NODE(4,9,1,10,0),
    WARP_NODE(5,9,1,10,0),
    WARP_NODE(6,9,1,10,0),
    RETURN()
};
